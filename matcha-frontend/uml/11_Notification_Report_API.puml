@startuml
skinparam DPI 300
title Notification & User Report API - GET/PUT/DELETE /api/user/notification & POST /api/user/report

participant Client
participant "Backend API" as API

note over Client, API
Get Notifications with Pagination
end note

Client -> API: GET /api/user/notification\nAuth: Bearer <token>\nQuery: limit=20, offset=0
activate API
API --> Client: HTTP 200\n{Notification[]}\n{id, userId, type, message, createdAt, read}\nExample: [{id: "123", type: "VIEW", message: "User X viewed your profile", read: false, createdAt: "2025-12-03T10:00:00Z"}]
deactivate API

Client -> API: GET /api/user/notification\nAuth: Bearer <token>\nQuery: limit=invalid
activate API
API --> Client: HTTP 400\n{msg: "limit must be a number"}
deactivate API

Client -> API: GET /api/user/notification\nAuth: Bearer <token>\nQuery: limit=20, offset=50\nLoad more (pagination)
activate API
API --> Client: HTTP 200\n{Notification[]}\nNext 20 notifications (offset skips first 50)
deactivate API

Client -> API: GET /api/user/notification\nAuth: Bearer <token>\nQuery: limit=20, offset=0\nNo notifications
activate API
API --> Client: HTTP 200\n{Notification[]}\nEmpty array []
deactivate API

note over Client, API
Mark Notification as Read
end note

Client -> API: PUT /api/user/notification\nAuth: Bearer <token>\n{notificationId: ""}
activate API
API --> Client: HTTP 400\n{msg: "notificationId required"}
deactivate API

Client -> API: PUT /api/user/notification\nAuth: Bearer <token>\n{notificationId: "invalid_id"}
activate API
API --> Client: HTTP 404\n{msg: "Notification not found"}
deactivate API

Client -> API: PUT /api/user/notification\nAuth: Bearer <token>\n{notificationId: "valid_id"}\nFirst time marking as read
activate API
API --> Client: HTTP 200\n{msg: "notification marked as read"}
deactivate API

Client -> API: PUT /api/user/notification\nAuth: Bearer <token>\n{notificationId: "valid_id"}\nAlready read
activate API
API --> Client: HTTP 200\n{msg: "notification marked as read"}
deactivate API

note over Client, API
Delete Notification
end note

Client -> API: DELETE /api/user/notification\nAuth: Bearer <token>\n{notificationId: ""}
activate API
API --> Client: HTTP 400\n{msg: "notificationId required"}
deactivate API

Client -> API: DELETE /api/user/notification\nAuth: Bearer <token>\n{notificationId: "invalid_id"}
activate API
API --> Client: HTTP 404\n{msg: "Notification not found"}
deactivate API

Client -> API: DELETE /api/user/notification\nAuth: Bearer <token>\n{notificationId: "valid_id"}
activate API
API --> Client: HTTP 200\n{msg: "notification deleted"}
deactivate API

note over Client, API
Report User - Validation Errors
end note

Client -> API: POST /api/user/report/:userId\nAuth: Bearer <token>\n{reason: "short"}
activate API
API --> Client: HTTP 400\n{msg: "Reason must be at least 10 characters"}
deactivate API

Client -> API: POST /api/user/report/:userId\nAuth: Bearer <token>\n{reason: "This is an extremely long report that exceeds the maximum character limit set by the system and should be rejected by the backend..."}
activate API
API --> Client: HTTP 400\n{msg: "Reason cannot exceed 500 characters"}
deactivate API

note over Client, API
Report User - Business Logic Errors
end note

Client -> API: POST /api/user/report/:selfUserId\nAuth: Bearer <token>\n{reason: "Valid reason with enough characters"}
activate API
API --> Client: HTTP 400\n{msg: "Cannot report yourself"}
deactivate API

Client -> API: POST /api/user/report/:nonexistentUserId\nAuth: Bearer <token>\n{reason: "Valid reason with enough characters"}
activate API
API --> Client: HTTP 404\n{msg: "User not found"}
deactivate API

note over Client, API
Report User - Duplicate Report
end note

Client -> API: POST /api/user/report/:userId\nAuth: Bearer <token>\n{reason: "Valid reason text with sufficient length"}\nAlready reported same user
activate API
API --> Client: HTTP 409\n{msg: "You have already reported this user"}
deactivate API

note over Client, API
Report User - Success
end note

Client -> API: POST /api/user/report/:userId\nAuth: Bearer <token>\n{reason: "Valid reason text with sufficient length"}\nFirst report
activate API
API --> Client: HTTP 200\n{msg: "Report submitted successfully"}
deactivate API

API -> API: Report effects:\n- Report stored in database\n- Admin can review reports\n- Multiple reports on same user increase action priority\n- Reporter can check report status (if implemented)

@enduml
