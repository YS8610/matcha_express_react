@startuml
skinparam DPI 300
title Social Interactions API - Extended

participant Client
participant "Backend API" as API

note over Client, API
Like User
end note

Client -> API: POST /api/user/liked\nAuth: Bearer <token>\n{userid: "self_id"}\nLiking self
activate API
API --> Client: HTTP 400\n{msg: "Cannot like yourself"}
deactivate API

Client -> API: POST /api/user/liked\nAuth: Bearer <token>\n{userid: "nonexistent"}
activate API
API --> Client: HTTP 404\n{msg: "User not found"}
deactivate API

Client -> API: POST /api/user/liked\nAuth: Bearer <token>\n{userid: "blocked_user"}\nTarget user blocked you
activate API
API --> Client: HTTP 403\n{msg: "Cannot like blocked user"}
deactivate API

Client -> API: POST /api/user/liked\nAuth: Bearer <token>\n{userid: "user_id"}\nAlready liked
activate API
API --> Client: HTTP 409\n{msg: "You already liked this user"}
deactivate API

Client -> API: POST /api/user/liked\nAuth: Bearer <token>\n{userid: "user_id"}\nNew like
activate API
API --> Client: HTTP 200\n{msg: "liked"}\nReturns match status if mutual
deactivate API

note over Client, API
Unlike User
end note

Client -> API: DELETE /api/user/liked\nAuth: Bearer <token>\n{userid: "never_liked"}
activate API
API --> Client: HTTP 404\n{msg: "Like relationship not found"}
deactivate API

Client -> API: DELETE /api/user/liked\nAuth: Bearer <token>\n{userid: "user_id"}\nPreviously liked
activate API
API --> Client: HTTP 200\n{msg: "unliked"}
deactivate API

note over Client, API
Get Users Who Liked You
end note

Client -> API: GET /api/user/liked/by\nAuth: Bearer <invalid_token>
activate API
API --> Client: HTTP 401\n{msg: "Unauthorized"}
deactivate API

Client -> API: GET /api/user/liked/by\nAuth: Bearer <token>
activate API
API --> Client: HTTP 200\n{data: [ProfileShort[]]}\nUsers who liked you\nArray may be empty
deactivate API

note over Client, API
Get Matched Users
end note

Client -> API: GET /api/user/liked/matched\nAuth: Bearer <token>
activate API
API --> Client: HTTP 200\n{data: [ProfileShort[]]}\nMutual likes (matches)\nEmpty if no matches
deactivate API

note over Client, API
View User Profile (Record View)
end note

Client -> API: POST /api/user/viewed\nAuth: Bearer <token>\n{viewedUserID: "self_id"}\nViewing self
activate API
API --> Client: HTTP 400\n{msg: "Cannot view your own profile"}
deactivate API

Client -> API: POST /api/user/viewed\nAuth: Bearer <token>\n{viewedUserID: "nonexistent"}
activate API
API --> Client: HTTP 404\n{msg: "User not found"}
deactivate API

Client -> API: POST /api/user/viewed\nAuth: Bearer <token>\n{viewedUserID: "user_id"}\nUser blocked you
activate API
API --> Client: HTTP 403\n{msg: "Cannot view blocked user"}
deactivate API

Client -> API: POST /api/user/viewed\nAuth: Bearer <token>\n{viewedUserID: "user_id"}\nFirst view
activate API
API --> Client: HTTP 200\n{msg: "view recorded"}
deactivate API

Client -> API: POST /api/user/viewed\nAuth: Bearer <token>\n{viewedUserID: "user_id"}\nViewed same user twice
activate API
API --> Client: HTTP 409\n{msg: "User already viewed"}
deactivate API

note over Client, API
Get My Views
end note

Client -> API: GET /api/user/viewed\nAuth: Bearer <token>
activate API
API --> Client: HTTP 200\n{data: [ProfileShort[]]}\nProfiles you viewed\nOrdered by recent
deactivate API

note over Client, API
Get Who Viewed You
end note

Client -> API: GET /api/user/viewed/by\nAuth: Bearer <token>
activate API
API --> Client: HTTP 200\n{data: [ProfileShort[]]}\nUsers who viewed you\nOrdered by recent
deactivate API

note over Client, API
Block User
end note

Client -> API: POST /api/user/block\nAuth: Bearer <token>\n{userId: "self_id"}
activate API
API --> Client: HTTP 400\n{msg: "Cannot block yourself"}
deactivate API

Client -> API: POST /api/user/block\nAuth: Bearer <token>\n{userId: "user_id"}\nNot exists
activate API
API --> Client: HTTP 404\n{msg: "User not found"}
deactivate API

Client -> API: POST /api/user/block\nAuth: Bearer <token>\n{userId: "user_id"}\nAlready blocked
activate API
API --> Client: HTTP 409\n{msg: "User already blocked"}
deactivate API

Client -> API: POST /api/user/block\nAuth: Bearer <token>\n{userId: "user_id"}\nNew block
activate API
API --> Client: HTTP 200\n{msg: "User blocked successfully"}
deactivate API

note over Client, API
Get Blocked Users
end note

Client -> API: GET /api/user/block\nAuth: Bearer <token>
activate API
API --> Client: HTTP 200\n{data: [ProfileShort[]]}\nList of blocked users\nMay be empty
deactivate API

note over Client, API
Unblock User
end note

Client -> API: DELETE /api/user/block\nAuth: Bearer <token>\n{userId: "never_blocked"}
activate API
API --> Client: HTTP 404\n{msg: "User not blocked"}
deactivate API

Client -> API: DELETE /api/user/block\nAuth: Bearer <token>\n{userId: "user_id"}\nPreviously blocked
activate API
API --> Client: HTTP 200\n{msg: "User unblocked successfully"}
deactivate API

@enduml
